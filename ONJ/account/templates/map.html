{%extends 'base.html' %}
{% load static %}
{%block title%}간단한 지도 표시하기{%endblock%}

{%block head%}
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no">
    
    <script type="text/javascript" src="https://oapi.map.naver.com/openapi/v3/maps.js?ncpClientId={{naver}}"></script>
{%endblock%}

{%block content%}

<div>
    <form>
        
        <div id="map" style="width:100%;height:400px;"></div>
        <label for="position">위치 검색: </label>
        <input type="text" id="position" name="position">
        <button>검색</button>
    </form>
</div>




<script>
  
    function getLocation(){
        if(navigator.geolocation){
            navigator.geolocation.getCurrentPosition(showPosition,showError,{enableHighAccuracy:true})
        }else{
            alert('Geolocation is not supported by this browser.');
        }
    }

    function showPosition(position){
        var latitude = position.coords.latitude;
        var longitude  = position.coords.longitude;
        initMap(latitude, longitude)
    }
    function showError(){
        switch(error.code){
            case error.PERMISSION_DENIED:
                alert('사용자가 위치 정보를 허용하지 않았습니다.');
                break;
            case error.POSITION_UNAVAILABLE:
                alert('위치 정보를 사용 할 수 없습니다.');
                break;
            case error.TIMEOUT:
                alert('위치 정보 요청이 시간 초과 되었습니다.');
                break;
            case error.UNKNOWN_ERROR:
                alert('알 수 없는 오류가 발생 했습니다.');
                break;
        }
    }

    function initMap(latitude, longitude){
        var mapOptions = {
            center : new naver.maps.LatLng(latitude, longitude),
            zoom : 14,
        };
        var map = new naver.maps.Map('map', mapOptions);
        console.log(latitude, longitude);
        new naver.maps.Marker({
            position : new naver.maps.LatLng(latitude, longitude),
            map: map
        });
    }
    
    window.onload = getLocation;

    
</script>
{%endblock%}